!function(){"use strict";function a(){}function b(){}angular.module("gjTimerApp",["ui.bootstrap","gjTimer"]),angular.module("gjTimerApp").config(a).run(b)}(),function(){"use strict";angular.module("gjTimer.services",[]),angular.module("gjTimer.filters",[]),angular.module("gjTimer",["gjTimer.services","gjTimer.filters","cub","menuBar","results","scramble","statistics","timer"])}(),function(){"use strict";function a(a,b){var c="#FFFFFF",d="#EEEEEE",e=32,f=13;a.style={body:{},section:{},timer:{}},a.keydown=function(c){event.keyCode===f?b.isTyping?event.preventDefault():b.$broadcast("new scramble",a.eventId):event.keyCode===e&&event.preventDefault(),b.$broadcast("keydown",c)},a.keyup=function(a){b.$broadcast("keyup",a)},a.$on("timer focus",function(){a.style.body={"background-color":d},a.style.section={display:"none"},a.style.timer={"margin-top":"2.9375em"}}),a.$on("timer unfocus",function(){a.style.body={"background-color":c},a.style.section={display:"block"},a.style.timer={}})}angular.module("gjTimer").controller("gjTimerController",["$scope","$rootScope",a])}(),function(){"use strict";function a(){return function(a){return void 0!==a?a.slice().reverse():[]}}angular.module("gjTimer.filters").filter("reverse",a)}(),function(){"use strict";function a(){var a=this;a.DNF=864e6,a.calculateAverage=function(b,c){var d=b.slice(0);return c&&(d.splice(d.indexOf(Math.min.apply(null,d)),1),d.splice(d.indexOf(Math.max.apply(null,d)),1)),d.indexOf(a.DNF)>=0||0===d.length?a.DNF:Number((d.reduce(function(a,b){return a+b},0)/d.length).toFixed())},a.calculateAverageString=function(b,c,d){return a.convertTimeFromMillisecondsToString(a.calculateAverage(b,c),d)},a.calculateStandardDeviation=function(b,c){var d=b.slice(0);if(c&&(d.splice(d.indexOf(Math.min.apply(null,d)),1),d.splice(d.indexOf(Math.max.apply(null,d)),1)),d.indexOf(a.DNF)>=0||0===d.length)return a.DNF;var e=a.calculateAverage(d,!1),f=d.map(function(a){return Math.pow(a-e,2)});return Number(Math.sqrt(a.calculateAverage(f,!1)).toFixed())},a.calculateStandardDeviationString=function(b,c,d){return a.convertTimeFromMillisecondsToString(a.calculateStandardDeviation(b,c),d)},a.calculateSessionMeanAndStandardDeviationString=function(b,c){for(var d=b.slice(0),e=0;e<d.length;e++)d[e]===a.DNF&&d.splice(e,1);return{mean:a.calculateAverageString(d,!1,c),stDev:a.calculateStandardDeviationString(d,!1,c)}},a.calculateBestAverageAndStandardDeviationString=function(b,c,d,e){for(var f,g=a.DNF,h=-1,i=0;i<b.length-d;i++)f=a.calculateAverage(b.slice(i,i+d),c),g>f&&(g=f,h=i);return{index:h,avg:a.convertTimeFromMillisecondsToString(g,e),stDev:a.calculateStandardDeviationString(b.slice(h,h+d),c,e)}},a.extractRawTimes=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].rawTime);return b},a.countNonDNFs=function(b){for(var c=0,d=0;d<b.length;d++)b[d]!==a.DNF&&(c+=1);return c},a.convertTimeFromStringToMilliseconds=function(b){if("DNF"===b)return a.DNF;if("N/A"===b)return-1;var c=b.split(":");return 1===c.length?Number((1e3*parseFloat(c[0])).toFixed()):2===c.length?Number((60*parseFloat(c[0])*1e3+1e3*parseFloat(c[1])).toFixed()):3===c.length?Number((60*parseFloat(c[0])*60*1e3+60*parseFloat(c[1])*1e3+1e3*parseFloat(c[2])).toFixed()):a.DNF},a.convertTimeFromMillisecondsToString=function(b,c){if(0>b||b===1/0)return"N/A";if(b===a.DNF)return"DNF";var d=moment(b),e=2===c?"SS":"SSS";return 1e4>b?d.format("s."+e):6e4>b?d.format("ss."+e):36e5>b?d.format("m:ss."+e):d.utc().format("H:mm:ss."+e)}}angular.module("gjTimer.services").service("Calculator",a)}(),function(){"use strict";function a(){var a=this;a.events={333:{index:0,name:"Rubik's Cube",style:{"font-size":"16pt"},svg:{ratio:.75,width:250}},444:{index:1,name:"4x4 Cube",style:{"font-size":"15pt"},svg:{ratio:.75,width:250}},555:{index:2,name:"5x5 Cube",style:{"font-size":"15pt"},svg:{ratio:.75,width:250}},222:{index:3,name:"2x2 Cube",style:{"font-size":"16pt"},svg:{ratio:.75,width:250}},"333bf":{index:4,name:"3x3 blindfolded",style:{"font-size":"16pt"},svg:{ratio:.75,width:250}},"333oh":{index:5,name:"3x3 one-handed",style:{"font-size":"16pt"},svg:{ratio:.75,width:250}},minx:{index:6,name:"Megaminx",style:{"font-size":"13pt"},svg:{ratio:.51,width:175}},pyram:{index:7,name:"Pyraminx",style:{"font-size":"16pt"},svg:{ratio:.69,width:250}},sq1:{index:8,name:"Square-1",style:{"font-size":"15pt"},svg:{ratio:.57,width:175}},clock:{index:9,name:"Rubik's Clock",style:{"font-size":"15pt"},svg:{ratio:.5,width:175}},666:{index:10,name:"6x6 Cube",style:{"font-size":"13pt"},svg:{ratio:.75,width:250}},777:{index:11,name:"7x7 Cube",style:{"font-size":"13pt"},svg:{ratio:.75,width:250}},"444bf":{index:12,name:"4x4 blindfolded",style:{"font-size":"15pt"},svg:{ratio:.75,width:250}},"555bf":{index:13,name:"5x5 blindfolded",style:{"font-size":"15pt"},svg:{ratio:.75,width:250}}},a.getEvents=function(){var b=[];return angular.forEach(a.events,function(a){b[a.index]=a.name}),b},a.getEvent=function(b){return a.events.hasOwnProperty(b)?a.events[b].name:null},a.getEventId=function(b){for(var c in a.events)if(a.events.hasOwnProperty(c)&&a.events[c].name===b)return c;return null},a.getEventStyle=function(b){return a.events.hasOwnProperty(b)?a.events[b].style:a.events[333].style},a.getEventSvg=function(b){return a.events.hasOwnProperty(b)?a.events[b].svg:a.events[333].svg}}angular.module("gjTimer.services").service("Events",a)}(),function(){"use strict";function a(){var a=this;a.get=function(a){return localStorage.getItem(a)},a.set=function(a,b){try{return localStorage.setItem(a,b),!0}catch(c){return!1}},a.getJSON=function(a){var b=localStorage.getItem(a);return null!==b?JSON.parse(b):null},a.setJSON=function(a,b){try{return localStorage.setItem(a,JSON.stringify(b)),!0}catch(c){return!1}},a.clear=function(){try{return localStorage.clear(),!0}catch(a){return!1}}}angular.module("gjTimer.services").service("LocalStorage",a)}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"dist/components/gjTimer/cub/cub.html",controller:"CubController",controllerAs:"ctrl",scope:!0,bindToController:!0}}angular.module("cub",[]).directive("cub",a)}(),function(){"use strict";function a(a,b){var c=this;a.$on("draw scramble",function(a,d,e){c.cub=b.drawScramble(d,e)})}angular.module("cub").controller("CubController",["$scope","CubService",a])}(),function(){"use strict";function a(a,b){var c=this;c.drawScramble=function(c,d){var e=b.getEventSvg(c).width,f=e/b.getEventSvg(c).ratio,g=document.createElement("div");scramblers[c].drawScramble(g,d,f,e);var h=document.createElement("div");return h.appendChild(g),a.trustAsHtml(h.innerHTML)}}angular.module("cub").service("CubService",["$sce","Events",a])}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"dist/components/gjTimer/menuBar/menuBar.html",controller:"MenuBarController",controllerAs:"ctrl",scope:{eventId:"=",results:"=",sessionId:"=",settings:"="},bindToController:!0}}angular.module("menuBar",[]).directive("menuBar",a)}(),function(){"use strict";function a(a,b,c,d,e,f){var g=this;g.settings=e.initSettings(),g.sessions=e.initSessions(),g.session=e.initSession(),g.events=f.getEvents(),g.event={eventId:g.session.eventId,event:f.getEvent(g.session.eventId)},g.sessionId=g.session.sessionId,g.eventId=g.session.eventId,g.showDetails=window.innerWidth>500,$(window).resize(function(){g.showDetails=window.innerWidth>500,a.$apply()}),c(function(){b.$broadcast("new scramble",g.eventId)},50),g.changeSession=function(a){g.session=e.changeSession(a),g.sessionId=a,g.eventId=g.session.eventId,b.$broadcast("refresh results",a),g.event.eventId!==g.session.eventId&&b.$broadcast("new scramble",g.eventId),g.event={eventId:g.eventId,event:f.getEvent(g.eventId)}},g.changeEvent=function(a){g.eventId=e.changeEvent(g.sessionId,f.getEventId(a)),g.session.eventId=g.eventId,g.event={eventId:g.eventId,event:f.getEvent(g.eventId)},b.$broadcast("new scramble",g.eventId)},g.openSettings=function(){d.open({animation:!0,templateUrl:"dist/components/gjTimer/settings/settings.html",controller:"SettingsController",controllerAs:"ctrl",size:"md",resolve:{settings:function(){return g.settings}}})},g.resetSession=function(){confirm("Are you sure you want to reset "+g.sessionId+"?")&&(e.resetSession(g.sessionId),g.session.results=[],g.results=[])}}angular.module("menuBar").controller("MenuBarController",["$scope","$rootScope","$timeout","$uibModal","MenuBarService","Events",a])}(),function(){"use strict";function a(a){var b=this,c=15,d={input:"timer",timerStartDelay:50,timerStopDelay:50,resultsPrecision:2,timerPrecision:3,timerRefreshInterval:50};b.initSettings=function(){var b=a.getJSON("settings");if(null===b)return a.setJSON("settings",d),d;for(var c in d)d.hasOwnProperty(c)&&(b.hasOwnProperty(c)||(b[c]=d[c],a.setJSON("settings",b)));return b},b.saveSettings=function(b){a.setJSON("settings",b)},b.initSessions=function(){for(var b=[],d=1;c>=d;d++){b.push("Session "+d);var e=a.getJSON("Session "+d);null===e&&a.setJSON("Session "+d,{sessionId:"Session "+d,eventId:"333",results:[]})}return b},b.initSession=function(){var b;return null!==a.get("sessionId")?b=a.get("sessionId"):(b="Session 1",a.set("sessionId","Session 1")),a.getJSON(b)},b.getSession=function(b){return a.getJSON(b)},b.changeSession=function(b){return a.set("sessionId",b),a.getJSON(b)},b.resetSession=function(b){var c=a.getJSON(b);c.results=[],a.setJSON(b,c)},b.changeEvent=function(b,c){var d=a.getJSON(b);return d.eventId=c,a.setJSON(b,d),d.eventId},b.resetAll=function(){a.clear()}}angular.module("menuBar").service("MenuBarService",["LocalStorage",a])}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"dist/components/gjTimer/results/results.html",controller:"ResultsController",controllerAs:"ctrl",scope:{results:"=",sessionId:"=",settings:"="},bindToController:!0}}angular.module("results",[]).directive("results",a)}(),function(){"use strict";function a(a,b,c){var d=this;d.results=c.getResults(d.sessionId,d.settings.resultsPrecision),a.$on("refresh results",function(a,b){d.results=c.getResults(b||d.sessionId,d.settings.resultsPrecision)}),d.openModal=function(a,c){a>=c&&b.open({animation:!0,templateUrl:"dist/components/gjTimer/resultsModal/resultsModal.html",controller:"ResultsModalController",controllerAs:"ctrl",size:"lg",resolve:{results:function(){return d.results.slice(a-c,a)},precision:function(){return d.settings.resultsPrecision}}})}}angular.module("results").controller("ResultsController",["$scope","$uibModal","ResultsService",a])}(),function(){"use strict";function a(a,b){var c=this,d=b.DNF;c.getResults=function(e,f){for(var g=[],h=a.getJSON(e).results,i=0;i<h.length;i++){var j=h[i].split("|"),k={index:i,scramble:j[1],date:new Date(Number(j[2])),comment:j[3]?j[3]:""};"+"===j[0].substring(j[0].length-1,j[0].length)?(k.time=Number(j[0].substring(0,j[0].length-1)),k.penalty="+2",k.rawTime=Number((k.time+2e3).toFixed()),k.displayedTime=b.convertTimeFromMillisecondsToString(Number(j[0].substring(0,j[0].length-1))+2e3,f)+"+",k.detailedTime=k.displayedTime):"-"===j[0].substring(j[0].length-1,j[0].length)?(k.time=Number(j[0].substring(0,j[0].length-1)),k.penalty="DNF",k.rawTime=d,k.displayedTime="DNF",k.detailedTime="DNF("+b.convertTimeFromMillisecondsToString(Number(j[0].substring(0,j[0].length-1)),f)+")"):(k.time=Number(j[0]),k.penalty="",k.rawTime=k.time,k.displayedTime=b.convertTimeFromMillisecondsToString(Number(j[0]),f),k.detailedTime=k.displayedTime),g.push(k)}for(var l=b.extractRawTimes(g),m=0;m<g.length;m++)g[m]=c.populateAverages(l,g[m],m,f);return g},c.saveResult=function(d,e,f,g,h){var i=b.convertTimeFromStringToMilliseconds(e),j=b.convertTimeFromMillisecondsToString(i,h),k={comment:"",date:new Date,detailedTime:j,displayedTime:j,index:d.length,penalty:"",rawTime:i,scramble:f,time:i},l=b.extractRawTimes(d);l.push(b.extractRawTimes([k])[0]),k=c.populateAverages(l,k,k.index,h),d.push(k);var m=a.getJSON(g);m.results.push(b.convertTimeFromStringToMilliseconds(e)+"|"+f+"|"+Date.now()),a.setJSON(g,m)},c.populateAverages=function(a,c,d,e){return d>=4?c.avg5=b.calculateAverageString(a.slice(d-4,d+1),!0,e):c.avg5="DNF",d>=11?c.avg12=b.calculateAverageString(a.slice(d-11,d+1),!0,e):c.avg12="DNF",c},c.penalty=function(c,d,e,f,g){var h=a.getJSON(d),i=h.results[e],j=i.substring(i.indexOf("|")-1,i.indexOf("|"));switch(f){case"":c.penalty="",c.displayedTime=b.convertTimeFromMillisecondsToString(c.time,g),c.detailedTime=c.displayedTime,("+"===j||"-"===j)&&(i=i.substring(0,i.indexOf("|")-1)+i.substring(i.indexOf("|"),i.length));break;case"+2":c.penalty="+2",c.displayedTime=b.convertTimeFromMillisecondsToString(c.time+2e3,g)+"+",c.detailedTime=c.displayedTime,i="+"===j||"-"===j?i.substring(0,i.indexOf("|")-1)+"+"+i.substring(i.indexOf("|"),i.length):i.substring(0,i.indexOf("|"))+"+"+i.substring(i.indexOf("|"),i.length);break;case"DNF":c.penalty="DNF",c.displayedTime="DNF",c.detailedTime="DNF("+b.convertTimeFromMillisecondsToString(c.time,g)+")",i="+"===j||"-"===j?i.substring(0,i.indexOf("|")-1)+"-"+i.substring(i.indexOf("|"),i.length):i.substring(0,i.indexOf("|"))+"-"+i.substring(i.indexOf("|"),i.length)}h.results[e]=i,a.setJSON(d,h)},c.remove=function(b,c,d){b.splice(d,1);var e=a.getJSON(c);e.results.splice(d,1),a.setJSON(c,e)},c.comment=function(b,c,d,e){b.comment=e;var f=a.getJSON(c),g=f.results[d].split("|");""!==e?g[3]?(g[3]=e,f.results[d]=g.join("|")):f.results[d]=f.results[d]+"|"+e:g[3]&&(g.splice(3,1),f.results[d]=g.join("|")),a.setJSON(c,f)}}angular.module("results").service("ResultsService",["LocalStorage","Calculator",a])}(),function(){"use strict";function a(a,b,c,d){var e=this;e.results=d.getModalResults(b,c),e.type=3===b.length?"mean":"average",e.close=function(){a.dismiss()}}angular.module("results").controller("ResultsModalController",["$modalInstance","results","ResultsModalService",a])}(),function(){"use strict";function a(a){var b=this;b.getModalResults=function(b,c){var d=a.extractRawTimes(b);return b[d.indexOf(Math.min.apply(null,d))].min=!0,b[d.indexOf(Math.max.apply(null,d))].max=!0,{results:b,avg:a.calculateAverageString(d,!0,c),stDev:a.calculateStandardDeviationString(d,!0,c)}}}angular.module("results").service("ResultsModalService",["Calculator",a])}(),function(){"use strict";function a(a,b,c,d,e){function f(c,d){g().then(function(e){a.insidePopover=-1,$(d).popover({animation:!1,content:e,html:!0,placement:"right",title:c.ctrl.result.detailedTime}),$(d).bind("mouseenter",function(){c.ctrl.insideDiv=c.ctrl.index,b(function(){$(d).popover("show"),c.ctrl.attachEvents(d)},1)}),$(d).bind("mouseleave",function(){c.ctrl.insideDiv=-1,b(function(){a.insidePopover!==c.ctrl.index&&$(d).popover("hide")},1)})})}function g(){var a=d.defer(),b=e.get("dist/components/gjTimer/resultsPopover/resultsPopover.html");return"undefined"==typeof b?c.get("dist/components/gjTimer/resultsPopover/resultsPopover.html").success(function(b){e.put("dist/components/gjTimer/resultsPopover/resultsPopover.html",b),a.resolve(b)}):a.resolve(b),a.promise}return{restrict:"E",scope:{index:"=",precision:"=",result:"=",results:"=",sessionId:"="},controller:"ResultsPopoverController",controllerAs:"ctrl",bindToController:!0,link:f}}angular.module("results").directive("resultsPopover",["$rootScope","$timeout","$http","$q","$templateCache",a])}(),function(){"use strict";function a(a,b,c,d){var e=this,f=13;e.attachEvents=function(g){$(".popover").on("mouseenter",function(){b.insidePopover=e.index}).on("mouseleave",function(){b.insidePopover=-1,c(function(){e.insideDiv!==e.index&&$(g).popover("hide")},1)}),$(".popover-btn-penalty-ok").on("click",function(){d.penalty(e.result,e.sessionId,e.index,"",e.precision),a.$apply(),$(g).popover("hide")}),$(".popover-btn-penalty-plus").on("click",function(){d.penalty(e.result,e.sessionId,e.index,"+2",e.precision),a.$apply(),$(g).popover("hide")}),$(".popover-btn-penalty-dnf").on("click",function(){d.penalty(e.result,e.sessionId,e.index,"DNF",e.precision),a.$apply(),$(g).popover("hide")}),$(".popover-btn-remove").on("click",function(){confirm("Are you sure you want to delete this time?")&&(d.remove(e.results,e.sessionId,e.index),a.$apply(),$(g).popover("hide"))}),$(".popover-input-comment").on("focus",function(){b.isTyping=!0}).on("blur",function(){b.isTyping=!1}).on("keydown",function(b){b.keyCode===f&&(d.comment(e.result,e.sessionId,e.index,$(".popover-input-comment")[0].value),a.$apply(),$(g).popover("hide"))})[0].value=e.result.comment}}angular.module("results").controller("ResultsPopoverController",["$scope","$rootScope","$timeout","ResultsService",a])}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"dist/components/gjTimer/scramble/scramble.html",controller:"ScrambleController",controllerAs:"ctrl",scope:{eventId:"=",scramble:"="},bindToController:!0}}angular.module("scramble",[]).directive("scramble",a)}(),function(){"use strict";function a(a,b,c,d,e){var f=this;a.$on("new scramble",function(a,g){f.scramble=d.getNewScramble(g),f.displayedScramble=c.trustAsHtml(f.scramble),f.scrambleStyle=e.getEventStyle(g),b.$broadcast("draw scramble",g,d.getScrambleState())})}angular.module("scramble").controller("ScrambleController",["$scope","$rootScope","$sce","ScrambleService","Events",a])}(),function(){"use strict";function a(){var a=this;a.getScrambleState=function(){return a.scramble.state},a.getNewScramble=function(b){return a.scramble=scramblers[b].getRandomScramble()," "===a.scramble.scramble_string.substring(a.scramble.scramble_string.length-1,a.scramble.scramble_string.length)?a.scramble.scramble_string.substring(0,a.scramble.scramble_string.length-1):a.scramble.scramble_string}}angular.module("scramble").service("ScrambleService",a)}(),function(){"use strict";function a(a,b,c,d){var e=this;e.settings=c,e.options={input:["timer","keyboard","stackmat"],timerStartDelay:[0,50,100],resultsPrecision:[2,3],timerPrecision:[2,3]},e.save=function(){d.saveSettings(e.settings),b.dismiss(),a.$broadcast("refresh settings"),a.$broadcast("refresh results")},e.resetAll=function(){confirm("Are you sure you want to reset everything?")&&(d.resetAll(),b.dismiss(),a.$broadcast("refresh settings"),a.$broadcast("refresh results"))},e.close=function(){b.dismiss()}}angular.module("menuBar").controller("SettingsController",["$rootScope","$modalInstance","settings","MenuBarService",a])}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"dist/components/gjTimer/statistics/statistics.html",controller:"StatisticsController",controllerAs:"ctrl",scope:{results:"="},bindToController:!0}}angular.module("statistics",[]).directive("statistics",a)}(),function(){"use strict";function a(a,b,c){var d=this;a.$watch(function(){return d.results},function(){d.statistics=c.getStatistics(d.results)}),d.openModal=function(a,c){var e=d.statistics.averages[c].length,f="best"===a?d.statistics.averages[c].best.index:d.results.length-e;b.open({animation:!0,templateUrl:"dist/components/gjTimer/resultsModal/resultsModal.html",controller:"ResultsModalController",controllerAs:"ctrl",size:"lg",resolve:{results:function(){return d.results.slice(f,f+e)}}})}}angular.module("statistics").controller("StatisticsController",["$scope","$uibModal","StatisticsService",a])}(),function(){"use strict";function a(a){var b=this;b.getStatistics=function(b,c){var d=a.extractRawTimes(b),e={solves:{attempted:d.length,solved:a.countNonDNFs(d),best:a.convertTimeFromMillisecondsToString(Math.min.apply(null,d)),worst:a.convertTimeFromMillisecondsToString(Math.max.apply(null,d))},sessionMean:a.calculateSessionMeanAndStandardDeviationString(d,c),sessionAvg:{avg:a.calculateAverageString(d,!0,c),stDev:a.calculateStandardDeviationString(d,!0,c)},averages:[]};d.length>=3&&e.averages.push({type:"m",length:3,current:{avg:a.calculateAverageString(d.slice(d.length-3,d.length),!1,c),stDev:a.calculateStandardDeviationString(d.slice(d.length-3,d.length),!1,c)},best:a.calculateBestAverageAndStandardDeviationString(d,!1,3,c)});for(var f=[5,12,50,100],g=0;g<f.length;g++)d.length>=f[g]&&e.averages.push({type:"a",length:f[g],current:{avg:a.calculateAverageString(d.slice(d.length-f[g],d.length),!0,c),stDev:a.calculateStandardDeviation(d.slice(d.length-f[g],d.length),!0,c)},best:a.calculateBestAverageAndStandardDeviationString(d,!0,f[g],c)});return e}}angular.module("statistics").service("StatisticsService",["Calculator",a])}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"dist/components/gjTimer/timer/timer.html",controller:"TimerController",controllerAs:"ctrl",scope:{eventId:"=",results:"=",scramble:"=",sessionId:"=",settings:"="},bindToController:!0}}angular.module("timer",[]).directive("timer",a)}(),function(){"use strict";function a(a,b,c,d,e,f){var g,h=this,i="reset",j=32;h.time=2===h.settings.timerPrecision?moment(0).format("s.SS"):moment(0).format("s.SSS");var k={BLACK:{color:"#000000"},RED:{color:"#FF0000"},GREEN:{color:"#2EB82E"}};a.$on("refresh settings",function(){h.time=2===h.settings.timerPrecision?moment(0).format("s.SS"):moment(0).format("s.SSS")}),a.$on("keydown",function(a,e){"reset"===i&&e.keyCode===j?(i="keydown",h.time=2===h.settings.timerPrecision?moment(0).format("s.SS"):moment(0).format("s.SSS"),h.timerStyle=k.RED,d(function(){"keydown"===i&&(i="ready",h.timerStyle=k.GREEN,b.$broadcast("timer focus"))},h.settings.timerStartDelay)):"timing"===i&&(i="stopped",c.cancel(g),b.$broadcast("timer unfocus"),f.saveResult(h.results,h.time,h.scramble,h.sessionId,h.settings.resultsPrecision),b.$broadcast("new scramble",h.eventId))}),a.$on("keyup",function(a,b){h.timerStyle=k.BLACK,"ready"===i&&b.keyCode===j?(i="timing",e.startTimer(),g=c(function(){h.time=e.getTime(h.settings.timerPrecision)},h.settings.timerRefreshInterval)):"keydown"===i?i="reset":"stopped"===i&&d(function(){i="reset"},h.settings.timerStopDelay)})}angular.module("timer").controller("TimerController",["$scope","$rootScope","$interval","$timeout","TimerService","ResultsService",a])}(),function(){"use strict";function a(a,b){var c=this;c.getTime=function(a){return b.convertTimeFromMillisecondsToString(moment(Date.now()-c.startTime),a)},c.startTimer=function(){c.startTime=Date.now()}}angular.module("timer").service("TimerService",["LocalStorage","Calculator",a])}();