function updateTime(){var e=new Date-start,t=e%1e3,s=Math.floor(e/1e3)%60,a=Math.floor(e/1e3/60%60),t=pad3(t);if(0==a?timeElapsed=s+"."+t:(s=pad2(s),timeElapsed=a+":"+s+"."+t),1==updateTimer){var o=splitTime(s+"."+t);$("#timer").html(0==a?o[0]+"<small>"+o[1]+"</small>":a+":"+o[0]+"<small>"+o[1]+"</small>")}setTimeout(updateTime,50)}function printScramble(){var e=JSON.parse(localStorage.getItem("session"+sessionNumber)),t=1;$("#scrambleLength").val(e.scrambleLength),1==switchingSession&&scrambleType==e.scrambleType&&scrambleLength==e.scrambleLength&&(t=0),switchingSession=0,scrambleType=e.scrambleType,scrambleLength=e.scrambleLength,2==scrambleType?($("#scramble2x2").focus(),1==t&&$("#scramble").text(generate2x2Scramble(scrambleLength)).css("font-size","18pt")):4==scrambleType?($("#scramble4x4").focus(),1==t&&$("#scramble").text(generate4x4Scramble(scrambleLength)).css("font-size","18pt")):5==scrambleType?($("#scramble5x5").focus(),1==t&&$("#scramble").text(generate5x5Scramble(scrambleLength)).css("font-size","18pt")):6==scrambleType?($("#scramble6x6").focus(),1==t&&$("#scramble").text(generate6x6Scramble(scrambleLength)).css("font-size","16pt")):7==scrambleType?($("#scramble7x7").focus(),1==t&&$("#scramble").text(generate7x7Scramble(scrambleLength)).css("font-size","14pt")):($("#scramble3x3").focus(),1==t&&$("#scramble").text(generate3x3Scramble(scrambleLength)).css("font-size","18pt"))}function printTimes(){updateAverages(),updateSessionInfo(),$("#times").text("");var e=JSON.parse(localStorage.getItem("session"+sessionNumber)),t='<div class="btn-toolbar" role="toolbar" aria-label="..."><div class="btn-group btn-group-xs" role="group" aria-label="..."><button type="button" class="btn btn-success" id="okButton">OK</button><button type="button" class="btn btn-warning" id="plus2Button">+2</button><button type="button" class="btn btn-danger" id="DNFButton">DNF</button></div><div class="btn-group btn-group-xs" role="group" aria-label="..."><button type="button" class="btn btn-default" id="deleteButton">X</button></div></div>';$("#"+this.id).attr("data-content",t);for(var s=0;s<e.numSolves;s++){var a=convertToTime(+convertToNumber(e.list[s].time)+2),o=splitTime(e.list[s].time)[0],r=splitTime(a)[0],n="<tr>\n<td>"+(s+1)+'</td>\n<td class="timesCell" id="timesCell'+(s+1)+'" title="<b>';n=n.concat(1==e.list[s].penalty?a+"+":2==e.list[s].penalty?"DNF("+e.list[s].time+"2)":e.list[s].time),n=n.concat('</b>" data-container="#timesCell'+(s+1)+'" data-toggle="popover" data-placement="right" data-content="">'),n=n.concat(1==e.list[s].penalty?r+"+":2==e.list[s].penalty?"DNF":o);var l=splitTime(e.list[s].avg5)[0],i=splitTime(e.list[s].avg12)[0];n=n.concat('</td>\n<td class="avg5Cell" id="avg5Cell'+(s+1)+'" data-toggle="modal" data-target="#myModal">'+l+'</td>\n<td class="avg12Cell" id="avg12Cell'+(s+1)+'" data-toggle="modal" data-target="#myModal">'+i+"</td></tr>"),$("#times").prepend(n)}$("#avg5").text(e.numSolves>=5?"avg5: "+e.list[e.numSolves-1].avg5:"avg5: DNF"),$("#avg12").text(e.numSolves>=12?"avg12: "+e.list[e.numSolves-1].avg12:"avg12: DNF"),$(".timesCell").hover(function(){typingComment=1;var t=this.id.substring(9);solveIndex=this.id.substring(9),$("#"+this.id).attr("title",t);var s='<div class="btn-toolbar" role="toolbar" aria-label="..."><div class="btn-group btn-group-xs" role="group" aria-label="..."><button type="button" class="btn btn-success okButton" id="okButton'+solveIndex+'"><span class="glyphicon glyphicon-ok" aria-hidden="true"></span></button><button type="button" class="btn btn-warning plus2Button" id="plus2Button'+solveIndex+'">+2</button><button type="button" class="btn btn-danger DNFButton" id="DNFButton'+solveIndex+'">DNF</button></div><div class="btn-group btn-group-xs" role="group" aria-label="..."><button type="button" class="btn btn-default deleteButton" id="deleteButton'+solveIndex+'"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button></div></div><input type="text" maxlength="50" class="form-control input-sm commentInput" id="commentInput'+solveIndex+'" placeholder="comment">';$("#"+this.id).attr("data-content",s),$(document).on("keydown",function(e){13===e.keyCode&&(fired=1)}),$(document).on("keyup",function(t){13===t.keyCode&&1==fired&&(e.list[solveIndex-1].comment=$(".commentInput").val(),localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),printTimes(),fired=0)})},function(){typingComment=0}),$(".timesCell").popover({html:!0,trigger:"hover",placement:"right",animation:!1}).on({show:function(e){var t=$("#"+this.id);t.data("hoveringPopover",!0),t.data("waitingForPopoverTO")&&e.stopImmediatePropagation()},hide:function(e){var t=$("#"+this.id);return t.data("forceHidePopover")?(t.data("forceHidePopover",!1),!0):(e.stopImmediatePropagation(),clearTimeout(t.data("popoverTO")),t.data("hoveringPopover",!1),t.data("waitingForPopoverTO",!0),t.data("popoverTO",setTimeout(function(){t.data("hoveringPopover")||(t.data("forceHidePopover",!0),t.data("waitingForPopoverTO",!1),t.popover("hide"))},0)),!1)}}).on({show:function(){console.log("shown")},hide:function(){console.log("hidden")}}),$(document).off("click",".okButton").on("click",".okButton",function(){solveIndex=this.id.substring(8),e=JSON.parse(localStorage.getItem("session"+sessionNumber)),e.list[solveIndex-1].penalty=0,localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),printTimes()}),$(document).off("click",".plus2Button").on("click",".plus2Button",function(){solveIndex=this.id.substring(11),e=JSON.parse(localStorage.getItem("session"+sessionNumber)),e.list[solveIndex-1].penalty=1,localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),printTimes()}),$(document).off("click",".DNFButton").on("click",".DNFButton",function(){solveIndex=this.id.substring(9),e=JSON.parse(localStorage.getItem("session"+sessionNumber)),e.list[solveIndex-1].penalty=2,localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),printTimes()}),$(document).off("click",".deleteButton").on("click",".deleteButton",function(){confirm("How many timesyou delete to get that average?")&&(solveIndex=this.id.substring(12),e=JSON.parse(localStorage.getItem("session"+sessionNumber)),solveIndex>-1&&(e.list.splice(solveIndex-1,1),e.numSolves-=1,typingComment=0),localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),printTimes())}),$(document).off("click",".avg5Cell").on("click",".avg5Cell",function(){var t=this.id.substring(8),a=new Date(e.list[t-1].date);if($("#myModal").css("top","25%"),$("#myModalTitle").text("Average of 5: "+e.list[t-1].avg5),$("#myModalFooter").html("<p>"+a.toLocaleString()+"</p>"),$("#myModalBody").text(""),t>=5){var o=[],r=0;for(s=0;5>s;s++){var n=convertToNumber(e.list[t-1-s].time);1==e.list[t-1-s].penalty?o[s]=(+n+2).toFixed(3):2==e.list[t-1-s].penalty?(o[s]=-1,r+=1):o[s]=n}var l=0,i=0,c=o[0],m=o[0],b=0;for(-1==o[0]&&(l=1,c=o[1]),j=0;j<5;j++)-1==+o[j]&&(i=j,m=o[j],b=1),+o[j]>+m&&0==b&&(i=j,m=o[j]),+o[j]<+c&&+o[j]>0&&(l=j,c=o[j]);for(l==t-1&&i==t-1&&(l=t-2),s=4;s>=0;s--){console.log(t-1-s);var d="",u=splitTime(e.list[t-1-s].time)[0],g=splitTime((+e.list[t-1-s].time+2).toFixed(3))[0];d=d.concat("<p>"+(5-s)+". "),(s==l||s==i)&&(d=d.concat("(")),d=d.concat(1==e.list[t-1-s].penalty?g+"+":2==e.list[t-1-s].penalty?"DNF("+u+")":u),(s==l||s==i)&&(d=d.concat(")")),d=d.concat(" "+e.list[t-1-s].scramble),null!=e.list[t-1-s].comment&&""!=e.list[t-1-s].comment&&(d=d.concat(" ("+e.list[t-1-s].comment+")")),d=d.concat("</p>"),$("#myModalBody").append(d)}}}),$(document).off("click",".avg12Cell").on("click",".avg12Cell",function(){var t=this.id.substring(9),a=new Date(e.list[t-1].date);if($("#myModal").css("top","15%"),$("#myModalTitle").text("Average of 12: "+e.list[t-1].avg12),$("#myModalFooter").html("<p>"+a.toLocaleString()+"</p>"),$("#myModalBody").text(""),t>=12){var o=[],r=0;for(s=0;12>s;s++){var n=convertToNumber(e.list[t-1-s].time);1==e.list[t-1-s].penalty?o[s]=(+n+2).toFixed(3):2==e.list[t-1-s].penalty?(o[s]=-1,r+=1):o[s]=n}var l=0,i=0,c=o[0],m=o[0],b=0;for(-1==o[0]&&(l=1,c=o[1]),j=0;j<12;j++)-1==+o[j]&&(i=j,m=o[j],b=1),+o[j]>+m&&0==b&&(i=j,m=o[j]),+o[j]<+c&&+o[j]>0&&(l=j,c=o[j]);for(l==t-1&&i==t-1&&(l=t-2),s=11;s>=0;s--){console.log(t-1-s);var d="",u=splitTime(e.list[t-1-s].time)[0],g=splitTime((+e.list[t-1-s].time+2).toFixed(3))[0];d=d.concat("<p>"+(12-s)+". "),(s==l||s==i)&&(d=d.concat("(")),d=d.concat(1==e.list[t-1-s].penalty?g+"+":2==e.list[t-1-s].penalty?"DNF("+u+")":u),(s==l||s==i)&&(d=d.concat(")")),d=d.concat(" "+e.list[t-1-s].scramble),null!=e.list[t-1-s].comment&&""!=e.list[t-1-s].comment&&(d=d.concat(" ("+e.list[t-1-s].comment+")")),d=d.concat("</p>"),$("#myModalBody").append(d)}}})}function updateSessionInfo(){var e=JSON.parse(localStorage.getItem("session"+sessionNumber)),t=0,s=9999999999,a=-1;for(solvesAttempted=e.list.length,solvesCompleted=e.list.length,i=0;i<solvesAttempted;i++){var o=convertToNumber(e.list[i].time);2==e.list[i].penalty?solvesCompleted--:1==e.list[i].penalty?(t+=+o+2,+s>+o&&(s=(+o+2).toFixed(3)),+o>+a&&(a=(+o+2).toFixed(3))):(t+=+o,+s>+o&&(s=o),+o>+a&&(a=o))}mean=0==t?"N/A":(t/solvesAttempted).toFixed(3),sessionMean=convertToTime(mean),9999999999==s&&(s="N/A"),-1==a&&(a="N/A"),sessionBest=convertToTime(s),sessionWorst=convertToTime(a),0==e.list.length&&(sessionMean="N/A",sessionBest="N/A",sessionWorst="N/A"),$("#sessionSolves").html("<b>Solves: "+solvesCompleted+"/"+solvesAttempted+"</b>"),$("#sessionMean").html("<b>Mean: "+sessionMean+"</b>")}function updateAverages(){var e=JSON.parse(localStorage.getItem("session"+sessionNumber));for(i=0;i<e.list.length;i++){if(i>=4){var t=[],s=0;for(j=0;j<5;j++){var a=convertToNumber(e.list[i-j].time);1==e.list[i-j].penalty?t[j]=(+a+2).toFixed(3):2==e.list[i-j].penalty?(t[j]=-1,s+=1):t[j]=a}var o=0,r=0,n=t[0],l=t[0],c=0;for(-1==t[0]&&(o=1,n=t[1]),j=0;j<5;j++)-1==+t[j]&&(r=j,l=t[j],c=1),+t[j]>+l&&0==c&&(r=j,l=t[j]),+t[j]<+n&&+t[j]>0&&(o=j,n=t[j]);o==i&&r==i&&(o-=1);var m=0;for(j=0;j<5;j++)j!=o&&j!=r&&(m+=+t[j]);e.list[i].avg5=convertToTime((m/3).toFixed(3)),s>1&&(e.list[i].avg5="DNF")}if(i>=11){var t=[],s=0;for(j=0;j<12;j++){var a=convertToNumber(e.list[i-j].time);1==e.list[i-j].penalty?t[j]=(+a+2).toFixed(3):2==e.list[i-j].penalty?(t[j]=-1,s+=1):t[j]=a}var o=0,r=0,n=t[0],l=t[0],c=0;for(-1==t[0]&&(o=1,n=t[1]),j=0;j<12;j++)-1==+t[j]&&(r=j,l=t[j],c=1),+t[j]>+l&&0==c&&(r=j,l=t[j]),+t[j]<+n&&+t[j]>0&&(o=j,n=t[j]);o==i&&r==i&&(o-=1);var m=0;for(j=0;j<12;j++)j!=o&&j!=r&&(m+=+t[j]);e.list[i].avg12=convertToTime((m/10).toFixed(3)),s>1&&(e.list[i].avg12="DNF")}}localStorage.setItem("session"+sessionNumber,JSON.stringify(e))}function splitTime(e){return"DNF"==e?["DNF",""]:[e.substr(0,e.length-1),lastDigit=e.substr(e.length-1,e.lenth),lastDigit]}function convertToNumber(e){if("DNF"==e)return"DNF";if(e.length<7)return e;var t,s;return 8==e.length?(t=e.substr(0,1),s=e.substr(2,8)):9==e.length&&(t=e.substr(0,2),s=e.substr(3,9)),(60*+t+ +s).toFixed(3)}function convertToTime(e){if("DNF"==e)return"DNF";var t=Math.floor(e/60),s=(e%60).toFixed(3);return 0==t?s:10>s?t+":0"+s:t+":"+s}function calculateMeanOf3(e,t,s){if(2==e.penalty||2==t.penalty||2==s.penalty)return"DNF";var a=convertToNumber(e.time),o=convertToNumber(t.time),r=convertToNumber(s.time);return 1==e.penalty&&(a=+a+2),1==t.penalty&&(o=+o+2),1==s.penalty&&(r=+r+2),((+a+ +o+ +r)/3).toFixed(3)}function calculateAverageOfN(e){var t="DNF",s=[],a=0;for(i=0;i<e.length;i++){var o=convertToNumber(e[i].time);1==e[i].penalty?s[i]=(+o+2).toFixed(3):2==e[i].penalty?(s[i]=-1,a+=1):s[i]=o}var r=0,n=0,l=s[0],c=s[0],m=0;for(-1==s[0]&&(r=1,l=s[1]),j=0;j<e.length;j++)-1==+s[j]&&(n=j,c=s[j],m=1),+s[j]>+c&&0==m&&(n=j,c=s[j]),+s[j]<+l&&+s[j]>0&&(r=j,l=s[j]);r==i&&n==i&&(r-=1);var b=0;for(j=0;j<e.length;j++)j!=r&&j!=n&&(b+=+s[j]);return t=convertToTime((b/e.length).toFixed(3)),a>1&&(t="DNF"),t}function calculateBestAverageOfN(e,t){if(e.length<t)return"DNF";var s="DNF",a=[],o=0,r=0,n=a[0],l=a[0],c=0,m="DNF",b=0,d=0;for(i=0;i<e.length;i++){var u=convertToNumber(e[i].time);a[i]=1==e[i].penalty?(+u+2).toFixed(3):2==e[i].penalty?9999999999:u}for(9999999999==a[0]&&(o=1,n=a[1]),j=0;j<t;j++)9999999999==+a[j]&&(r=j,l=a[j],c=1),+a[j]>+l&&0==c&&(r=j,l=a[j]),+a[j]<+n&&+a[j]>0&&(o=j,n=a[j]);for(o==i&&r==i&&(o-=1),i=0;i<t;i++)9999999999==a[i]&&(d+=1),i!=o&&i!=r&&(b+=+a[i]);for(2>d&&(m=b),i=t;i<e.length;i++){if(9999999999==a[i]&&(d+=1),9999999999==a[i-t]&&(d-=1),r==i-t||o==i-t){var g=0;for(r==i-t&&(g=1),r=i-t+1,o=i-t+1,l=a[i-t+1],n=a[i-t+1],j=i-t+1;j<i;j++)+a[j]>+l&&(r=j,l=a[j]),+a[j]<+n&&(o=j,n=a[j]);b+=+a[i],b-=1==g?+a[r]:+a[o]}else b+=+a[i],b-=+a[i-t];+a[i]>+l&&(b+=+a[r],b-=+a[i],r=i,l=a[i]),+a[i]<+n&&(b+=+a[o],b-=+a[i],o=i,n=a[i]),(m>b||"DNF"==m)&&2>d&&(m=b)}return"DNF"==m?"DNF":s=convertToTime((m/t).toFixed(3))}function pad2(e){return e>9?e:"0"+e}function pad3(e){return e>99?e:e>9?"0"+e:"00"+e}function generate2x2Scramble(e){var t="",s=-1;for(i=0;i<e;i++){for(var a=Math.floor(3*Math.random()),o=Math.floor(3*Math.random());a==s;)a=Math.floor(3*Math.random()),innerTurningLayer=Math.floor(2*Math.random()),o=Math.floor(3*Math.random());switch(0==a?t=t.concat("U"):1==a?t=t.concat("F"):2==a&&(t=t.concat("R")),o){case 1:t=t.concat("'");break;case 2:t=t.concat("2")}s=a,i<e-1&&(t=t.concat(" "))}return t}function generate3x3Scramble(e){var t=-1,s=-1,a="";for(i=0;i<e;i++){var o=Math.floor(6*Math.random()),r=Math.floor(3*Math.random());for((0==t&&1!=s||1==t&&0!=s||2==t&&3!=s||3==t&&2!=s||4==t&&5!=s||5==t&&4!=s)&&(s=-1);o==t||o==s;)o=Math.floor(6*Math.random());switch(o){case 0:a=a.concat("U");break;case 1:a=a.concat("D");break;case 2:a=a.concat("L");break;case 3:a=a.concat("R");break;case 4:a=a.concat("F");break;case 5:a=a.concat("B")}switch(r){case 1:a=a.concat("'");break;case 2:a=a.concat("2")}s=t,t=o,i<e-1&&(a=a.concat(" "))}return a}function generate4x4Scramble(e){var t="",s=0,a=-1,o=-1;for(i=0;i<e;i++){var r=Math.floor(3*Math.random()),n=Math.floor(3*Math.random()),l=Math.floor(2*Math.random()),c=Math.floor(3*Math.random());switch(r!=a&&(s=0),n){case 0:o=1;break;case 1:o=2;break;case 2:o=4}for(;a==r&&(o&s)>0;)r=Math.floor(3*Math.random()),n=Math.floor(3*Math.random()),l=Math.floor(2*Math.random()),c=Math.floor(3*Math.random()),r!=a&&(s=0);switch(0==r?t=t.concat(0==n?"U":2==n?"D":0==l?"Uw":"Dw"):1==r?t=t.concat(0==n?"F":2==n?"B":0==l?"Fw":"Bw"):2==r&&(t=t.concat(0==n?"L":2==n?"R":0==l?"Lw":"Rw")),n){case 0:s+=1;break;case 1:s+=2;break;case 2:s+=4}switch(c){case 1:t=t.concat("'");break;case 2:t=t.concat("2")}a=r,i<e-1&&(t=t.concat(" "))}return t}function generate5x5Scramble(e){var t="",s=0,a=-1,o=-1;for(i=0;i<e;i++){var r=Math.floor(3*Math.random()),n=Math.floor(4*Math.random()),l=Math.floor(3*Math.random());switch(r!=a&&(s=0),n){case 0:o=1;break;case 1:o=2;break;case 2:o=4;break;case 3:o=8}for(;a==r&&(o&s)>0;)r=Math.floor(3*Math.random()),n=Math.floor(4*Math.random()),l=Math.floor(3*Math.random()),r!=a&&(s=0);switch(0==r?t=t.concat(0==n?"U":1==n?"Uw":2==n?"Dw":"D"):1==r?t=t.concat(0==n?"F":1==n?"Fw":2==n?"Bw":"B"):2==r&&(t=t.concat(0==n?"L":1==n?"Lw":2==n?"Rw":"R")),n){case 0:s+=1;break;case 1:s+=2;break;case 2:s+=4;break;case 3:s+=8}switch(l){case 1:t=t.concat("'");break;case 2:t=t.concat("2")}a=r,i<e-1&&(t=t.concat(" "))}return t}function generate6x6Scramble(e){var t="",s=0,a=-1,o=-1;for(i=0;i<e;i++){var r=Math.floor(3*Math.random()),n=Math.floor(5*Math.random()),l=Math.floor(2*Math.random()),c=Math.floor(3*Math.random());switch(r!=a&&(s=0),n){case 0:o=1;break;case 1:o=2;break;case 2:o=4;break;case 3:o=8;break;case 4:o=16}for(;a==r&&(o&s)>0;)r=Math.floor(3*Math.random()),n=Math.floor(5*Math.random()),l=Math.floor(2*Math.random()),c=Math.floor(3*Math.random()),r!=a&&(s=0);switch(0==r?t=t.concat(0==n?"U":1==n?"D":2==n?"Uw":3==n?"Dw":0==l?"3Uw":"3Dw"):1==r?t=t.concat(0==n?"F":1==n?"B":2==n?"Fw":3==n?"Bw":0==l?"3Fw":"3Bw"):2==r&&(t=t.concat(0==n?"L":1==n?"R":2==n?"Lw":3==n?"Rw":0==l?"3Lw":"3Rw")),n){case 0:s+=1;break;case 1:s+=2;break;case 2:s+=4;break;case 3:s+=8;break;case 4:s+=16}switch(c){case 1:t=t.concat("'");break;case 2:t=t.concat("2")}a=r,i<e-1&&(t=t.concat(" "))}return t}function generate7x7Scramble(e){var t="",s=0,a=-1,o=-1;for(i=0;i<e;i++){var r=Math.floor(3*Math.random()),n=Math.floor(6*Math.random()),l=Math.floor(3*Math.random());switch(r!=a&&(s=0),n){case 0:o=1;break;case 1:o=2;break;case 2:o=4;break;case 3:o=8;break;case 4:o=16;break;case 5:o=32}for(;a==r&&(o&s)>0;)r=Math.floor(3*Math.random()),n=Math.floor(6*Math.random()),l=Math.floor(3*Math.random()),r!=a&&(s=0);switch(0==r?t=t.concat(0==n?"U":1==n?"D":2==n?"Uw":3==n?"Dw":4==n?"3Uw":"3Dw"):1==r?t=t.concat(0==n?"F":1==n?"B":2==n?"Fw":3==n?"Bw":4==n?"3Fw":"3Bw"):2==r&&(t=t.concat(0==n?"L":1==n?"R":2==n?"Lw":3==n?"Rw":4==n?"3Lw":"3Rw")),n){case 0:s+=1;break;case 1:s+=2;break;case 2:s+=4;break;case 3:s+=8;break;case 4:s+=16;break;case 5:s+=32}switch(l){case 1:t=t.concat("'");break;case 2:t=t.concat("2")}a=r,i<e-1&&(t=t.concat(" "))}return t}var start,stop,solveIndex,isTiming=0,updateTimer=0,allowedToUpdate=0,typingComment=0,modalOpen=0,fired=0,switchingSession=0,scrambleType=3,scrambleLength=20,sessionNumber=1,solvesAttempted,solvesCompleted,sessionMean,sessionBest,sessionWorst;$(document).ready(function(){for(null==localStorage.getItem("sessionNumber")?localStorage.setItem("sessionNumber",sessionNumber):sessionNumber=localStorage.getItem("sessionNumber"),null==localStorage.getItem("scrambleType")?localStorage.setItem("scrambleType",scrambleType):scrambleType=localStorage.getItem("scrambleType"),null==localStorage.getItem("scrambleLength")?localStorage.setItem("scrambleLength",scrambleLength):scrambleLength=localStorage.getItem("scrambleLength"),i=1;i<=20;i++)null==localStorage.getItem("session"+i)&&localStorage.setItem("session"+i,JSON.stringify({sessionNumber:i,scrambleType:3,scrambleLength:20,numSolves:0,list:[]}));$("#timer").html("0.00<small>0</small>"),printTimes(),$("#myModal").on("shown.bs.modal",function(){modalOpen=1,$("#resetAllButton").click(function(){confirm("Reset All?")&&(localStorage.clear(),location.reload())}),$("#cancelButton").click(function(){$("#myModal").modal("hide")}),$("#confirmResetButton").click(function(){$("#myModal").modal("toggle");var e={sessionNumber:i,scrambleType:scrambleType,scrambleLength:scrambleLength,numSolves:0,list:[]};localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),printTimes(),$("#timer").html("0.00<small>0</small>")})}),$("#myModal").on("hidden.bs.modal",function(){modalOpen=0}),$("#sessionDropdownButton").html("Session "+sessionNumber+' <span class="caret"></span>'),$("#sessionDropdownMenu li a").click(function(){switch($("#sessionDropdownButton").html($(this).text()+' <span class="caret"></span>').val($(this).text()),$(this).text()){case"Session 1":sessionNumber=1;break;case"Session 2":sessionNumber=2;break;case"Session 3":sessionNumber=3;break;case"Session 4":sessionNumber=4;break;case"Session 5":sessionNumber=5;break;case"Session 6":sessionNumber=6;break;case"Session 7":sessionNumber=7;break;case"Session 8":sessionNumber=8;break;case"Session 9":sessionNumber=9;break;case"Session 10":sessionNumber=10;break;case"Session 11":sessionNumber=11;break;case"Session 12":sessionNumber=12;break;case"Session 13":sessionNumber=13;break;case"Session 14":sessionNumber=14;break;case"Session 15":sessionNumber=15;break;case"Session 16":sessionNumber=16;break;case"Session 17":sessionNumber=17;break;case"Session 18":sessionNumber=18;break;case"Session 19":sessionNumber=19;break;case"Session 20":sessionNumber=20}2==scrambleType?$("#scramble2x2").focus():3==scrambleType?$("#scramble3x3").focus():4==scrambleType?$("#scramble4x4").focus():5==scrambleType?$("#scramble5x5").focus():6==scrambleType?$("#scramble6x6").focus():7==scrambleType?$("#scramble7x7").focus():$("#scramble3x3").focus(),localStorage.setItem("sessionNumber",sessionNumber),switchingSession=1,printScramble(),printTimes()}),$("#statsButton").click(function(){updateSessionInfo();var e=JSON.parse(localStorage.getItem("session"+sessionNumber)),t="DNF",s="DNF",a="DNF",o="DNF",r="DNF",n="DNF",l=calculateBestAverageOfN(e.list,50),c=calculateBestAverageOfN(e.list,100);for(e.numSolves>=3&&(a=convertToTime(calculateMeanOf3(e.list[e.numSolves-1],e.list[e.numSolves-2],e.list[e.numSolves-3]))),e.numSolves>=50&&(r=calculateAverageOfN(e.list.slice(e.numSolves-50,e.numSolves))),e.numSolves>=100&&(n=calculateAverageOfN(e.list.slice(e.numSolves-100,e.numSolves))),i=0;i<e.numSolves;i++){if(i>=2){var m=calculateMeanOf3(e.list[i],e.list[i-1],e.list[i-2]);("DNF"==o&&"DNF"!=m||+o>+m)&&(o=m)}var b=convertToNumber(e.list[i].avg5),d=convertToNumber(e.list[i].avg12);("DNF"==t&&"DNF"!=b||+t>+b)&&(t=b),("DNF"==s&&"DNF"!=d||+s>+d)&&(s=d)}var u=convertToTime(o),g=convertToTime(t),p=convertToTime(s);$("#myModal").css("top","15%"),$("#myModalTitle").text("Statistics "),$("#myModalBody").text(""),$("#myModalFooter").html("<p>"+new Date+"</p>"),$("#myModalBody").append('<div class="container"><div class="row" id="statsRow"><div class="col-xs-2"><b>Solves: '+solvesCompleted+"/"+solvesAttempted+'</div></b><div class="col-xs-2"><b>Mean: '+sessionMean+'</b></div></div><div class="row" id="statsRow"><div class="col-xs-2"><b>Best: '+sessionBest+'</div></b><div class="col-xs-2"><b>Worst: '+sessionWorst+'</b></div></div></div><div class="table-responsive"><table class="table table-bordered table-hover" id="statsTable"><thead><th></th><th>Current</th><th>Best</th></thead><tbody><tr><td>Mean of 3</td><td>'+a+"</td><td>"+u+"</td></tr><tr><td>Average of 5</td><td>"+e.list[e.numSolves-1].avg5+"</td><td>"+g+"</td></tr><tr><td>Average of 12</td><td>"+e.list[e.numSolves-1].avg12+"</td><td>"+p+"</td></tr><tr><td>Average of 50</td><td>"+r+"</td><td>"+l+"</td></tr><tr><td>Average of 100</td><td>"+n+"</td><td>"+c+"</td></tr></tbody></table></div>")}),$("#resetButton").click(function(){$("#myModal").css("top","30%"),$("#myModalTitle").text("Reset"),$("#myModalBody").html("Reset Session "+sessionNumber+"?"),$("#myModalFooter").html('<button type="button" class="btn btn-default" id="cancelButton">Cancel</button><button type="button" class="btn btn-danger" id="confirmResetButton">Reset</button>'),$("#resetButton").blur()}),$("#scramble2x2").click(function(){scrambleType=2,scrambleLength=10;var e=JSON.parse(localStorage.getItem("session"+sessionNumber));e.scrambleType=2,e.scrambleLength=10,localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),$("#scrambleLength").val(scrambleLength),$("#scramble").text(generate2x2Scramble(scrambleLength)).css("font-size","18pt"),localStorage.setItem("scrambleType",scrambleType),localStorage.setItem("scrambleLength",scrambleLength)}),$("#scramble3x3").click(function(){scrambleType=3,scrambleLength=20;var e=JSON.parse(localStorage.getItem("session"+sessionNumber));e.scrambleType=3,e.scrambleLength=20,localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),$("#scrambleLength").val(scrambleLength),$("#scramble").text(generate3x3Scramble(scrambleLength)).css("font-size","18pt"),localStorage.setItem("scrambleType",scrambleType),localStorage.setItem("scrambleLength",scrambleLength)}),$("#scramble4x4").click(function(){scrambleType=4,scrambleLength=40;var e=JSON.parse(localStorage.getItem("session"+sessionNumber));e.scrambleType=4,e.scrambleLength=40,localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),$("#scrambleLength").val(scrambleLength),$("#scramble").text(generate4x4Scramble(scrambleLength)).css("font-size","18pt"),localStorage.setItem("scrambleType",scrambleType),localStorage.setItem("scrambleLength",scrambleLength)}),$("#scramble5x5").click(function(){scrambleType=5,scrambleLength=60;var e=JSON.parse(localStorage.getItem("session"+sessionNumber));e.scrambleType=5,e.scrambleLength=60,localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),$("#scrambleLength").val(scrambleLength),$("#scramble").text(generate5x5Scramble(scrambleLength)).css("font-size","18pt"),localStorage.setItem("scrambleType",scrambleType),localStorage.setItem("scrambleLength",scrambleLength)}),$("#scramble6x6").click(function(){scrambleType=6,scrambleLength=80;var e=JSON.parse(localStorage.getItem("session"+sessionNumber));e.scrambleType=6,e.scrambleLength=80,localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),$("#scrambleLength").val(scrambleLength),$("#scramble").text(generate6x6Scramble(scrambleLength)).css("font-size","16pt"),localStorage.setItem("scrambleType",scrambleType),localStorage.setItem("scrambleLength",scrambleLength)}),$("#scramble7x7").click(function(){scrambleType=7,scrambleLength=100;var e=JSON.parse(localStorage.getItem("session"+sessionNumber));e.scrambleType=7,e.scrambleLength=100,localStorage.setItem("session"+sessionNumber,JSON.stringify(e)),$("#scrambleLength").val(scrambleLength),$("#scramble").text(generate7x7Scramble(scrambleLength)).css("font-size","14pt"),localStorage.setItem("scrambleType",scrambleType),localStorage.setItem("scrambleLength",scrambleLength)}),$("#newScrambleButton").click(function(){scrambleLength=$("#scrambleLength").val(),localStorage.setItem("scrambleType",scrambleType),localStorage.setItem("scrambleLength",scrambleLength),localStorage.setItem("scramble",$("#scramble").text()),localStorage.setItem("scrambleType",scrambleType),printScramble()}),$("#optionsButton").click(function(){$("#myModal").css("top","30%"),$("#myModalTitle").html("Options <small> (This feature is currently under devlopment)</small>"),$("#myModalBody").html('<button type="button" class="btn btn-danger" id="resetAllButton">Reset All</button>'),$("#myModalFooter").html("<p>"+new Date+"</p>")});var e,t,s,a,o;printScramble(),$(document).on("keydown",function(r){if(32==r.keyCode&&0==modalOpen&&($("#scrambleLength").blur(),r.prtDefault(),0==isTiming&&0==typingComment&&($("#timer").css("color","#2EB82E"),setTimeout(function(){$("body").css("background-color","rgba(0, 0 , 0, 0.8)"),$("#tableDiv").hide(),$("#scramble2x2").attr("disabled","true"),$("#scramble3x3").attr("disabled","true"),$("#scramble4x4").attr("disabled","true"),$("#scramble5x5").attr("disabled","true"),$("#scramble6x6").attr("disabled","true"),$("#scramble7x7").attr("disabled","true"),$("#scrambleLength").attr("disabled","true"),$("#newScrambleButton").attr("disabled","true"),$("#optionsButton").attr("disabled","true")},50))),13===r.keyCode&&0==typingComment&&0==modalOpen){r.prtDefault(),scrambleLength=$("#scrambleLength").val(),localStorage.setItem("scrambleType",scrambleType),localStorage.setItem("scrambleLength",scrambleLength);var n=JSON.parse(localStorage.getItem("session"+sessionNumber));n.scrambleLength=scrambleLength,localStorage.setItem("session"+sessionNumber,JSON.stringify(n)),$("#scrambleLength").blur(),printScramble()}if(1==allowedToUpdate&&0==modalOpen){$("body").css("background-color","white"),$("#tableDiv").show(),$("#scramble2x2").removeAttr("disabled"),$("#scramble3x3").removeAttr("disabled"),$("#scramble4x4").removeAttr("disabled"),$("#scramble5x5").removeAttr("disabled"),$("#scramble6x6").removeAttr("disabled"),$("#scramble7x7").removeAttr("disabled"),$("#scrambleLength").removeAttr("disabled"),$("#newScrambleButton").removeAttr("disabled"),$("#optionsButton").removeAttr("disabled"),updateTimer=0,allowedToUpdate=0,stop=new Date,o=stop-start,a=o%1e3,s=Math.floor(o/1e3)%60,t=Math.floor(o/1e3/60%60),a=pad3(a),0==t?e=s+"."+a:(s=pad2(s),e=t+":"+s+"."+a);var l=splitTime(s+"."+a);$("#timer").html(0==t?l[0]+"<small>"+l[1]+"</small>":t+":"+l[0]+"<small>"+l[1]+"</small>");var i={time:e,avg5:"DNF",avg12:"DNF",scramble:$("#scramble").text(),date:stop,penalty:0,comment:""},n=JSON.parse(localStorage.getItem("session"+sessionNumber));n.numSolves+=1,n.list.push(i),localStorage.setItem("session"+sessionNumber,JSON.stringify(n)),localStorage.setItem(pad2(localStorage.length+1),e),printTimes(),printScramble()}}),$(document).on("keyup",function(e){32===e.keyCode&&0==typingComment&&0==modalOpen&&(0==isTiming?($("#timer").css("color","black"),isTiming=1,updateTimer=1,allowedToUpdate=1,start=new Date,updateTime()):isTiming=0)})});